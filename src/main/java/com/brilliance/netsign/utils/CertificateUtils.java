package com.brilliance.netsign.utils;import org.bouncycastle.asn1.ASN1InputStream;import org.bouncycastle.asn1.ASN1Sequence;import org.bouncycastle.asn1.x509.Certificate;import org.springframework.util.Base64Utils;import java.io.ByteArrayInputStream;import java.io.IOException;import java.io.InputStream;/** * @Author: WeiBingtao/13156050650@163.com * @Version: 1.0 * @Description: * @Date: 2020/12/22 0022 10:34 */public class CertificateUtils {    public static Certificate parseCertificate(String base64CertString) throws IOException {        String prefix = "-----BEGIN CERTIFICATE-----";        String endf = "-----END CERTIFICATE-----";        String sepLine = "\r";        String sepLine2 = "\n";        if (base64CertString.indexOf(prefix) > -1) {            base64CertString = base64CertString.replace(sepLine, "");            base64CertString = base64CertString.replace(sepLine2, "");            base64CertString = base64CertString.replace(prefix, "");            base64CertString = base64CertString.replace(endf, "");        }        InputStream inStream = new ByteArrayInputStream(Base64Utils.decodeFromString(base64CertString));        ASN1Sequence seq = null;        ASN1InputStream aIn;        aIn = new ASN1InputStream(inStream);        seq = (ASN1Sequence) aIn.readObject();        Certificate cert = Certificate.getInstance(seq);        return cert;    }}